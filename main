SELECT 

t1.[LEADER 0 ID]
,t1.[Leader 0 AHSN]
,t1.[Leader 0 Name]
,t1.[Leader 0 Position Title]
,t1.[Leader 0 Cost Center]
,t1.[Leader 0 Department]
,t1.[Leader 0 Entity]
,t1.[Leader 1 Name]
,t1.[Leader 1 Position]
,t1.[Leader 2 Name]
,t1.[Leader 2 Position]
,t1.[Leader 3 Name]
,t1.[Leader 3 Position]
,t1.[Leader 4 Name]
,t1.[Leader 4 Position]
,t1.[Leader 5 Name]
,t1.[Leader 5 Position]
,t1.[Leader 6 Name]
,t1.[Leader 6 Position]
,t1.[Leader 7 Name]
,t1.[Leader 7 Position]
--,t2.[Leader 0 Direct Reports #]

from 
(select DISTINCT

e.EMPLOYEE_ID as [Leader 0 ID]
,RTRIM(e.EMPLOYEE_AHSN) as [Leader 0 AHSN]
,RTRIM(e.EMPLOYEE_NAME) as [Leader 0 Name]
,RTRIM(e.POSITION_DESCRIPTION) as [Leader 0 Position Title]
,Replace(e.PROCESS_DEPARTMENT, '-', '') as [Leader 0 Cost Center]
,STUFF(e.DEPARTMENT_NAME,1,7,'') AS [Leader 0 Department]
,RTRIM(HRCOMM.ENTNAME) AS [Leader 0 Entity]


,RTRIM(e.SUPERVISOR_FULL_NAME) AS [Leader 1 Name]
,RTRIM(e.SUPERVISOR_POSITION) AS [Leader 1 Position]


,RTRIM(e2.SUPERVISOR_FULL_NAME) AS [Leader 2 Name]
,RTRIM(e2.SUPERVISOR_POSITION) AS [Leader 2 Position]


,RTRIM(e3.SUPERVISOR_FULL_NAME) AS [Leader 3 Name]
,RTRIM(e3.SUPERVISOR_POSITION) AS [Leader 3 Position]


,RTRIM(e4.SUPERVISOR_FULL_NAME) AS [Leader 4 Name]
,RTRIM(e4.SUPERVISOR_POSITION) AS [Leader 4 Position]


,RTRIM(e5.SUPERVISOR_FULL_NAME) AS [Leader 5 Name]
,RTRIM(e5.SUPERVISOR_POSITION) AS [Leader 5 Position]


,RTRIM(e6.SUPERVISOR_FULL_NAME) AS [Leader 6 Name]
,RTRIM(e6.SUPERVISOR_POSITION) AS [Leader 6 Position]


,RTRIM(e6.SUPERVISOR_FULL_NAME) AS [Leader 7 Name]
,RTRIM(e7.SUPERVISOR_POSITION) AS [Leader 7 Position]


from dbo.vwEmployeeCurrentViewAllEmployee e (NOLOCK)

LEFT JOIN LTMPROD.hcm.WORKASSIGNMENT as WA (NOLOCK)
ON e.EMPLOYEE_ID = WA.EMPLOYEE
AND WA.ACTIVE = 1

LEFT JOIN LTMPROD.hcm.POSITION p (NOLOCK)
ON e.POSITION_CODE = p.POSITION

LEFT JOIN LTMPROD.hcm.USERFIELD_STORAGE ufs (NOLOCK)
ON p.UNIQUEID = ufs.UFSUNIQUEID AND ufs.UFSFIELDNAME = 'NortonCheckRequestLevel'

left join dbo.vwEmployeeCurrentViewAllEmployee e2 (NOLOCK)
on e.SUPERVISOR_EMP_ID = e2.EMPLOYEE_ID

LEFT JOIN LTMPROD.hcm.POSITION p2 (NOLOCK)
ON e2.POSITION_CODE = p2.POSITION

LEFT JOIN LTMPROD.hcm.USERFIELD_STORAGE ufs2 (NOLOCK)
ON p2.UNIQUEID = ufs2.UFSUNIQUEID AND ufs2.UFSFIELDNAME = 'NortonCheckRequestLevel'

LEFT JOIN dbo.vwEmployeeCurrentViewAllEmployee e3 (NOLOCK)
ON e2.SUPERVISOR_EMP_ID = e3.EMPLOYEE_ID

LEFT JOIN LTMPROD.hcm.POSITION p3 (NOLOCK)
ON e3.POSITION_CODE = p3.POSITION

LEFT JOIN LTMPROD.hcm.USERFIELD_STORAGE ufs3 (NOLOCK)
ON p3.UNIQUEID = ufs3.UFSUNIQUEID AND ufs3.UFSFIELDNAME = 'NortonCheckRequestLevel'

LEFT JOIN dbo.vwEmployeeCurrentViewAllEmployee e4 (NOLOCK)
ON e3.SUPERVISOR_EMP_ID = e4.EMPLOYEE_ID

LEFT JOIN LTMPROD.hcm.POSITION p4 (NOLOCK)
ON e4.POSITION_CODE = p4.POSITION

LEFT JOIN LTMPROD.hcm.USERFIELD_STORAGE ufs4 (NOLOCK)
ON p4.UNIQUEID = ufs4.UFSUNIQUEID AND ufs4.UFSFIELDNAME = 'NortonCheckRequestLevel'

left join dbo.vwEmployeeCurrentViewAllEmployee e5 (NOLOCK)
on e4.SUPERVISOR_EMP_ID = e5.EMPLOYEE_ID

LEFT JOIN LTMPROD.hcm.POSITION p5 (NOLOCK)
ON e5.POSITION_CODE = p5.POSITION

LEFT JOIN LTMPROD.hcm.USERFIELD_STORAGE ufs5 (NOLOCK)
ON p5.UNIQUEID = ufs5.UFSUNIQUEID AND ufs5.UFSFIELDNAME = 'NortonCheckRequestLevel'

left join dbo.vwEmployeeCurrentViewAllEmployee e6 (NOLOCK)
on e5.SUPERVISOR_EMP_ID = e6.EMPLOYEE_ID

LEFT JOIN LTMPROD.hcm.POSITION p6 (NOLOCK)
ON e6.POSITION_CODE = p6.POSITION

LEFT JOIN LTMPROD.hcm.USERFIELD_STORAGE ufs6 (NOLOCK)
ON p6.UNIQUEID = ufs6.UFSUNIQUEID AND ufs6.UFSFIELDNAME = 'NortonCheckRequestLevel'

left join dbo.vwEmployeeCurrentViewAllEmployee e7 (NOLOCK)
on e6.SUPERVISOR_EMP_ID = e7.EMPLOYEE_ID

LEFT JOIN LTMPROD.hcm.POSITION p7 (NOLOCK)
ON e7.POSITION_CODE = p7.POSITION

LEFT JOIN LTMPROD.hcm.USERFIELD_STORAGE ufs7 (NOLOCK)
ON p7.UNIQUEID = ufs7.UFSUNIQUEID AND ufs7.UFSFIELDNAME = 'NortonCheckRequestLevel'

left join dbo.vwEmployeeCurrentViewAllEmployee e8 (NOLOCK)
on e7.SUPERVISOR_EMP_ID = e8.EMPLOYEE_ID

LEFT JOIN LTMPROD.hcm.POSITION p8 (NOLOCK)
ON e8.POSITION_CODE = p8.POSITION

LEFT JOIN LTMPROD.hcm.USERFIELD_STORAGE ufs8 (NOLOCK)
ON p8.UNIQUEID = ufs8.UFSUNIQUEID AND ufs8.UFSFIELDNAME = 'NortonCheckRequestLevel'

INNER JOIN LTMPROD.hcm.EMPLOYEE AS EWA (NOLOCK)
ON EWA.EMPLOYEE = e.EMPLOYEE_ID AND EWA.PRIMARYWORKASSIGNMENT = WA.WORKASSIGNMENT

 INNER JOIN (
    SELECT CC.HRORGANIZATION, CC.HRORGANIZATIONUNIT, CC.PARENTUNIT, CC.DESCRIPTION AS 'CCNAME', CC.ACTIVE, CC.UNITTYPE, SF.DESCRIPTION AS 'SFNAME',  FN.DESCRIPTION AS 'FNNAME', EN.DESCRIPTION AS 'ENTNAME'
    FROM   LTMPROD.hcm.HRORGANIZATIONUNIT CC
    JOIN LTMPROD.hcm.HRORGANIZATIONUNIT SF
    ON CC.PARENTUNIT=SF.HRORGANIZATIONUNIT
    JOIN LTMPROD.hcm.HRORGANIZATIONUNIT FN
    ON SF.PARENTUNIT=FN.HRORGANIZATIONUNIT 
    JOIN LTMPROD.hcm.HRORGANIZATIONUNIT SC
    ON FN.PARENTUNIT=SC.HRORGANIZATIONUNIT 
    JOIN LTMPROD.hcm.HRORGANIZATIONUNIT EN
    ON SC.PARENTUNIT=EN.HRORGANIZATIONUNIT
    WHERE  CC.UNITTYPE='COSTCENTER' AND CC.ACTIVE='1') 
    AS HRCOMM
    ON HRCOMM.HRORGANIZATIONUNIT = WA.HRORGANIZATIONUNIT

where 1=1  
AND e.STATUS IN ('ACTIVE','LEAVE','JOB PLACEMENT','ADMIN LEAVE','EXTENDLEAVE','PENDINGLEAVE')
AND e.RELATIONSHIPTOORGANIZATION = 'EMPLOYEE'
--and e.EMPLOYEE_ID =44106
AND e.PROCESS_DEPARTMENT LIKE '06%'
--AND e.CHECK_REQUEST_LEVEL <10
AND ((e.POSITION_DESCRIPTION LIKE 'Chief Administrative Officer%' or e.POSITION_DESCRIPTION LIke 'Sys VP%')
OR (e2.POSITION_DESCRIPTION LIKE 'Chief Administrative Officer%' or e2.POSITION_DESCRIPTION LIke 'Sys VP%')
OR (e3.POSITION_DESCRIPTION LIKE 'Chief Administrative Officer%' or e3.POSITION_DESCRIPTION LIke 'Sys VP%')
OR (e4.POSITION_DESCRIPTION LIKE 'Chief Administrative Officer%' or e4.POSITION_DESCRIPTION LIke 'Sys VP%')
OR (e5.POSITION_DESCRIPTION LIKE 'Chief Administrative Officer%' or e5.POSITION_DESCRIPTION LIke 'Sys VP%')
OR (e6.POSITION_DESCRIPTION LIKE 'Chief Administrative Officer%' or e6.POSITION_DESCRIPTION LIke 'Sys VP%')
OR (e7.POSITION_DESCRIPTION LIKE 'Chief Administrative Officer%' or e7.POSITION_DESCRIPTION LIke 'Sys VP%'))
) as T1


--left join 

--(
--select 
--SUPERVISOR_EMP_ID
--,COUNT(*) as [Leader 0 Direct Reports #]
--from dbo.vwEmployeeCurrentViewAllEmployee
--where 1=1
----and SUPERVISOR_EMP_ID = 362
--AND STATUS IN ('ACTIVE','LEAVE','JOB PLACEMENT','ADMIN LEAVE','EXTENDLEAVE','PENDINGLEAVE')
--AND RELATIONSHIPTOORGANIZATION = 'EMPLOYEE'
--group by SUPERVISOR_EMP_ID
----order by SupervisorCount desc
--) as t2 on t1.[Leader 0 ID] = t2.SUPERVISOR_EMP_ID



WHERE 1=1
--and t1.[Leader 0 ID] = 362




--Order by [Employee Check Approval Level (Number)],RTRIM(e.EMPLOYEE_NAME) asc



